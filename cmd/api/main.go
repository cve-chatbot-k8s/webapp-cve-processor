package main

import (
	"github.com/rs/zerolog"
	"github.com/rs/zerolog/log"
	_ "net/http/pprof"
	"time"
	"webapp/internal/processor"
)

func main() {
	// Use the below goroutine to profile the application
	// go tool pprof http://localhost:6060/debug/pprof/heap
	//go func() {
	//	log.Print(http.ListenAndServe("localhost:6060", nil))
	//}()
	zerolog.TimeFieldFormat = time.RFC3339
	proc := processor.NewProcessor()
	proc.DownloadCVERecords()
	log.Print("CVE records downloaded successfully")
	log.Print("Starting read records")
	err := proc.ReadRecords()
	if err != nil {
		log.Error().Msg("error reading records: " + err.Error())
		return
	}

	log.Print("Records read successfully")
}
